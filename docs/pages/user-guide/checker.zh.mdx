import { Callout, FileTree, Tab, Tabs } from "nextra-theme-docs";

# Checker

Checkerï¼Œå³ã€Œè‡ªå®šä¹‰åˆ¤åˆ†å™¨ã€ï¼Œé€šå¸¸ç”¨äºåœ¨æ­£ç¡®ç­”æ¡ˆä¸å”¯ä¸€çš„é¢˜ç›®å¯¹é€‰æ‰‹ç­”æ¡ˆè¿›è¡Œæ£€éªŒï¼Œæˆ–è€…ç»†åŒ–å¾—åˆ†éœ€æ±‚ï¼

Checker é€šå¸¸éœ€è¦å¤„ç†ä¸‰ä¸ªæ–‡ä»¶ï¼š

- æµ‹è¯•ç‚¹è¾“å…¥æ–‡ä»¶ï¼ˆ`inf`ï¼‰ï¼šå³é€‰æ‰‹ç¨‹åºè¿è¡Œæ—¶çš„è¾“å…¥æ–‡ä»¶ï¼
- é€‰æ‰‹è¾“å‡ºæ–‡ä»¶ï¼ˆ`ouf`ï¼‰ï¼šå³é€‰æ‰‹ç¨‹åºè¿è¡Œæ—¶äº§ç”Ÿçš„è¾“å‡ºæ–‡ä»¶ï¼
- æ ‡å‡†ç­”æ¡ˆæ–‡ä»¶ï¼ˆ`ans`ï¼‰ï¼šå‚¨å­˜æ­£ç¡®ç­”æ¡ˆçš„æ–‡ä»¶ï¼å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç­‰ä»·äºæ ‡å‡†ç¨‹åºï¼ˆstdï¼‰è¿è¡Œæ—¶äº§ç”Ÿçš„è¾“å‡ºæ–‡ä»¶ï¼

Checker é€šå¸¸éœ€è¦æ£€æµ‹ä¸¤ä¸ªæ¡ä»¶ï¼š

- æ ¹æ®æµ‹è¯•ç‚¹è¾“å…¥æ–‡ä»¶ï¼Œåˆ¤æ–­é€‰æ‰‹è¾“å‡ºæ˜¯å¦å…·æœ‰ã€Œæœ‰æ•ˆæ€§ã€ï¼
- æ¯”è¾ƒé€‰æ‰‹è¾“å‡ºå’Œæ ‡å‡†ç­”æ¡ˆï¼Œå¹¶æ£€éªŒå®ƒä»¬æ˜¯å¦å…·æœ‰ã€Œç­‰ä»·æ€§ã€ï¼

## åŸºç¡€

<Callout type="info">
æœ¬èŠ‚çš„ç›¸å…³ä»£ç è§ [GitHub ä»“åº“](https://github.com/rindag-devs/cplib/tree/main/tests/checker/0-i32-a-plus-b)ï¼
</Callout>

æˆ‘ä»¬å…ˆä»ä¸€é“ç®€å•çš„é¢˜ç›®å¼€å§‹è®²è§£ Checker çš„ç¼–å†™å’Œä½¿ç”¨ï¼

> **é¢˜ç›®æè¿°**ï¼šç»™å®šä¸¤ä¸ªæ•´æ•° $a$ å’Œ $b$ï¼ˆ$-1000 \le a,b \le 1000$ï¼‰ï¼ä½ éœ€è¦è¾“å‡º $a$ ä¸ $b$ çš„å’Œï¼

### ç¼–å†™

é¦–å…ˆæˆ‘ä»¬ä»ä¸€ä¸ªç©ºå·¥ä½œç›®å½•å¼€å§‹ï¼Œå°† `cplib.hpp` å¤åˆ¶åˆ°å·¥ä½œç›®å½•ä¸‹ï¼ç„¶åæ–°å»ºæ–‡ä»¶ `chk.cpp`ï¼Œå¹¶è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

```cpp filename="chk.cpp" copy showLineNumbers
#include "cplib.hpp"

using namespace cplib;

CPLIB_REGISTER_CHECKER(chk);

void checker_main() {
  auto var_ans = var::i32("ans", -2000, 2000);

  int ouf_output = chk.ouf.read(var_ans);
  int ans_output = chk.ans.read(var_ans);

  if (ouf_output != ans_output) {
    chk.quit_wa(format("Expected %d, got %d", ans_output, ouf_output));
  }

  chk.quit_ac();
}
```

æˆ‘ä»¬å°†é€è¡Œè®²è§£è¿™æ®µä»£ç ï¼

```cpp
using namespace cplib;
```

CPLib çš„ä¸»è¦åŠŸèƒ½éƒ½å­˜æ”¾åœ¨å‘½åç©ºé—´ `cplib` ä¸­ï¼ç”±äºç®—æ³•ç«èµ›ä½¿ç”¨çš„ç¨‹åºä¸€èˆ¬å¾ˆçŸ­å°ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè®²ï¼Œ`using namespace cplib;` å¯æå¤§ä¼˜åŒ–å¼€å‘æ•ˆç‡ï¼

```cpp
CPLIB_REGISTER_CHECKER(chk);
```

`CPLIB_REGISTER_CHECKER(name)` å®å°†æ‰€å«ç¨‹åºæ³¨å†Œæˆä¸€ä¸ª CPLib Checkerï¼Œå¹¶å°† Checker çš„çŠ¶æ€ä¿å­˜è‡³åç§°ä¸º `name` çš„å…¨å±€å˜é‡ä¸­ï¼ï¼ˆä»£ç ä¸­åç§°ä¸º `chk`ï¼‰ï¼`name` å¯æ›¿æ¢ä¸ºä»»æ„ç¬¦åˆ C++ è¯­æ³•çš„å˜é‡åï¼Œä½†åœ¨æœ¬æ–‡æ¡£ä¸­ï¼Œä¸ºäº†å¯è¯»æ€§å’Œç®€æ´æ€§ï¼Œå‡ä¼šä½¿ç”¨ `chk` ä½œä¸ºå…¨å±€çŠ¶æ€å˜é‡åï¼

```cpp
void checker_main() {
```

`checker_main` æ˜¯ä¸€ä¸ªè¢«æ³¨å†Œä¸º CPLib Checker çš„ç¨‹åºçš„ä¸»å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ä¼šåœ¨ CPLib å®Œæˆåˆå§‹åŒ–åè°ƒç”¨ä¸€æ¬¡ï¼Œç±»ä¼¼äºä¸€èˆ¬ C++ ç¨‹åºä¸­çš„ `main` å‡½æ•°ï¼è€ŒçœŸæ­£çš„ `main` å‡½æ•°å°†ä¼šç”± CPLib å®ç°ï¼

```cpp
  auto var_ans = var::i32("ans", -2000, 2000);
```

å£°æ˜ä¸€ä¸ª **å˜é‡è¯»å…¥æ¨¡æ¿**ï¼æ¨¡æ¿çš„ç±»å‹ä¸º `i32`ï¼ˆ32 ä½æœ‰ç¬¦å·æ•´æ•°ï¼‰ï¼Œå¹¶ç»™äºˆåç§° `ans`ï¼ä¸€ä¸ªå˜é‡è¯»å…¥æ¨¡æ¿è´Ÿè´£è¡¨è¿°å¦‚ä½•æŒ‰ç…§ç»™å®šæ–¹å¼è¯»å…¥ä¸€ä¸ªç»™å®šç±»å‹çš„å˜é‡ï¼

<Callout type="info">
`cplib::var::i32` æ˜¯ `cplib::var::Int<int32_t>` çš„ç±»å‹åˆ«åï¼`cplib::var::Int<T>` çš„æ„é€ å‡½æ•°å£°æ˜å‚è€ƒå¦‚ä¸‹ï¼š

- `explicit Int();`
- `explicit Int(std::string name);`
- `explicit Int(std::optional<T> min, std::optional<T> max);`
- `explicit Int(std::string name, std::optional<T> min, std::optional<T> max);`

å…¶ä¸­ `min` ä¸ `max` åˆ†åˆ«è§„å®šäº†æ•´æ•°çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼åœ¨æœ¬é¢˜ä¸­ï¼Œæœ€å°å€¼ä¸º $(-1000) + (-1000) = -2000$ï¼Œæœ€å¤§å€¼ä¸º $1000 + 1000 = 2000$ï¼`name` è§„å®šäº†å˜é‡çš„åç§°ï¼å½“è¯»å…¥å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå‡ºé”™å˜é‡çš„åç§°å°†ä¼šéšç€è¯»å…¥æ ˆè½¨è¿¹ï¼ˆTraceï¼‰ä¼šæ˜¾ç¤ºåœ¨é”™è¯¯ä¿¡æ¯ä¸­ï¼ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ²¡æœ‰ `name` å‚æ•°çš„æ„é€ å‡½æ•°é‡è½½æ¥çœç•¥åç§°å‚æ•°ï¼ä½†æ˜¯è¿™ä¹ˆåšä¼šä½¿å¾—å‘ç”Ÿé”™è¯¯æ—¶çš„æŠ¥å‘Šå¤±å»éƒ¨åˆ†é˜…è¯»æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬ **éå¸¸ä¸æ¨è** ä½ å»è¿™ä¹ˆåšï¼
</Callout>

```cpp
  int ouf_output = chk.ouf.read(var_ans);
  int ans_output = chk.ans.read(var_ans);
```

æ ¹æ®åˆšæ‰å®šä¹‰çš„å˜é‡è¯»å…¥æ¨¡ç‰ˆï¼Œä»é€‰æ‰‹è¾“å‡ºæ–‡ä»¶å’Œæ ‡å‡†ç­”æ¡ˆä¸­å„è¯»å–ä¸€ä¸ªæ•´æ•°ï¼æˆ‘ä»¬å¹¶ä¸éœ€è¦å…³å¿ƒè¯»å…¥æ ¼å¼çš„æ­£ç¡®æ€§å’Œæ•´æ•°èŒƒå›´çš„æ£€éªŒï¼ŒCPLib ä¼šè‡ªåŠ¨å®Œæˆä¸Šè¿°æ£€æŸ¥ï¼

å½“é€‰æ‰‹çš„è¾“å‡ºä¸ç¬¦åˆæ¡ä»¶æ—¶ï¼ŒCPLib ä¼šç«‹å³é€€å‡ºç¨‹åºï¼Œå¹¶ä»¥ Wrong Answer ä¸ºç»“æœè¿›è¡ŒæŠ¥å‘Šï¼ŒåŒæ—¶ç”Ÿæˆæ¸…æ™°çš„è¯»å…¥æ ˆè½¨è¿¹ï¼ˆTraceï¼‰ä¿¡æ¯ä»¥ä¾›å‚è€ƒï¼

å½“æ ‡å‡†ç­”æ¡ˆä¸ç¬¦åˆæ¡ä»¶æ—¶ï¼ŒCPLib çš„è¡¨ç°ä¸é€‰æ‰‹è¾“å‡ºé”™è¯¯æ—¶å¤§è‡´è¿‘ä¼¼ï¼ä¸åŒç‚¹åœ¨äºï¼Œæ­¤æ—¶è¿”å›çš„ç»“æœä¸º Internal Errorï¼å½“ç„¶åœ¨å®é™…é¢˜ç›®ä¸­ï¼Œæ ‡å‡†ç­”æ¡ˆå‡ºé”™è¿™ä¸€æƒ…å†µæ˜¯ä¸€å®šè¦æœç»å‘ç”Ÿçš„ï¼

```cpp
  if (ouf_output != ans_output) {
    chk.quit_wa(format("Expected %d, got %d", ans_output, ouf_output));
  }
```

åœ¨å‘ç°é€‰æ‰‹è¾“å‡ºå’Œæ ‡å‡†ç­”æ¡ˆä¸ä¸€è‡´æ—¶ï¼Œéœ€è¦è°ƒç”¨ `chk.quit_wa` å‡½æ•°æŠ¥å‘Š Wrong Answer å¹¶é€€å‡ºç¨‹åºï¼æˆ‘ä»¬æ¨èä½ åœ¨ä½¿ç”¨ `chk.quit_wa` ç³»åˆ—å‡½æ•°æ—¶ç»™å‡ºæ¸…æ™°çš„ä¿¡æ¯ï¼æ­¤å¤„ä½¿ç”¨ `cplib::format` å‡½æ•°å¯¹é”™è¯¯ä¿¡æ¯è¿›è¡Œæ ¼å¼åŒ–ï¼Œè¯¥å‡½æ•°ä½¿ç”¨ç±»ä¼¼ `printf` çš„æ ¼å¼ï¼Œå¯ä¾¿æ·åœ°æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼

```cpp
  chk.quit_ac();
```

`chk.quit_ac` æŠ¥å‘Š Acceptedï¼Œå³æ²¡æœ‰é”™è¯¯ï¼Œå¹¶é€€å‡ºç¨‹åºï¼

<Callout type="info">
å½“ä½ çš„ç­”æ¡ˆé”™è¯¯æ—¶ï¼Œæœ‰å¿…è¦è§£é‡Šä¸ºä»€ä¹ˆå‡ºé”™ï¼ä½†å½“ä½ çš„ç­”æ¡ˆæ­£ç¡®æ—¶ï¼Œè§£é‡Šä¸ºä»€ä¹ˆæ­£ç¡®å°±æ²¡æœ‰ä»»ä½•å¿…è¦äº†ï¼å› æ­¤ï¼ŒCPLib æ²¡æœ‰è®¾è®¡ï¼Œä¹Ÿä¸æ‰“ç®—è®¾è®¡ä¸€ä¸ªè¾“å‡ºè‡ªå®šä¹‰ä¿¡æ¯çš„ `chk.quit_ac` é‡è½½ï¼ä½†ä¸€åˆ‡éƒ½è¦è€ƒè™‘æ‰©å±•æ€§ï¼Œå¦‚æœä½ ç¡®å®æœ‰è¿™æ–¹é¢çš„éœ€æ±‚ï¼Œè¯·å‚é˜… [chk.quit]() å‡½æ•°çš„æ–‡æ¡£ï¼
</Callout>

<Callout type="warning">
æ³¨å†Œæˆä¸º CPLib çš„ç¨‹åºå¿…é¡»ä½¿ç”¨ `chk.quit*` ç³»åˆ—å‡½æ•°é€€å‡ºï¼Œè€Œ **ä¸å…è®¸** ç›´æ¥ä½¿ç”¨ `std::exit` ç­‰å‡½æ•°é€€å‡ºï¼
</Callout>

### ä½¿ç”¨

<Tabs items={['UNIX-like', 'Windows']} storageKey="selected-os">
<Tab>
æ‰“å¼€ç»ˆç«¯ï¼Œåˆ‡æ¢åˆ°åˆšæ‰å»ºç«‹çš„å·¥ä½œç›®å½•ï¼æ‰§è¡Œç¼–è¯‘å‘½ä»¤æ¥ç¼–è¯‘ Checkerï¼Œå®ƒé€šå¸¸ç±»ä¼¼äºè¿™æ ·ï¼š

```bash
g++ chk.cpp -o chk -std=c++17
```

<Callout type="warning">
CPLib æ‰€éœ€çš„æœ€ä½ C++ æ ‡å‡†ä¸º C++ 17ï¼
</Callout>

æ¥ä¸‹æ¥åœ¨å·¥ä½œç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ `data/`ï¼Œç”¨äºå­˜å‚¨æµ‹è¯• Checker ä½¿ç”¨çš„æµ‹è¯•ç‚¹ï¼Œå¹¶æ”¾å…¥æµ‹è¯•æ•°æ®ï¼æœ¬ä¾‹ä¸­ä»¥ `data/0.in`ã€`data/0.out`ã€`data/0.ans` ä½œä¸ºæµ‹è¯•æ•°æ®çš„åç§°ä»¥ä½œæ¼”ç¤ºï¼

æ­¤æ—¶çš„ä½ çš„å·¥ä½œç›®å½•ç»“æ„åº”è¯¥å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<FileTree>
  <FileTree.Folder name="data" defaultOpen>
    <FileTree.File name="0.ans" />
    <FileTree.File name="0.in" />
    <FileTree.File name="0.out" />
  </FileTree.Folder>
  <FileTree.File name="chk.cpp" />
  <FileTree.File name="cplib.hpp" />
</FileTree>

åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•ä½ çš„ Checkerï¼š

```bash
./chk data/0.in data/0.out data/0.ans
```

å¦‚æœåˆ°æ­¤ä¸ºæ­¢ä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šçœ‹åˆ° Checker è¾“å‡ºä»¥ä¸‹ç»“æœï¼š

```ansi
[0;32mAccepted[0m, scores [0;33m100.0[0m of 100.
```

</Tab>
<Tab>
æ‰“å¼€ cmd.exe æˆ– Windows Terminal ç¨‹åºï¼Œåˆ‡æ¢åˆ°åˆšæ‰å»ºç«‹çš„å·¥ä½œç›®å½•ï¼æ‰§è¡Œç¼–è¯‘å‘½ä»¤æ¥ç¼–è¯‘ Checkerï¼Œå®ƒé€šå¸¸ç±»ä¼¼äºè¿™æ ·ï¼š

```cmd
g++ chk.cpp -o chk.exe -std=c++17
```

<Callout type="warning">
CPLib æ‰€éœ€çš„æœ€ä½ C++ æ ‡å‡†ä¸º C++ 17ï¼
</Callout>

æ¥ä¸‹æ¥åœ¨å·¥ä½œç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ `data\`ï¼Œç”¨äºå­˜å‚¨æµ‹è¯• Checker ä½¿ç”¨çš„æµ‹è¯•ç‚¹ï¼Œå¹¶æ”¾å…¥æµ‹è¯•æ•°æ®ï¼æœ¬ä¾‹ä¸­ä»¥ `data\0.in`ã€`data\0.out`ã€`data\0.ans` ä½œä¸ºæµ‹è¯•æ•°æ®çš„åç§°ä»¥ä½œæ¼”ç¤ºï¼

æ­¤æ—¶çš„ä½ çš„å·¥ä½œç›®å½•ç»“æ„åº”è¯¥å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<FileTree>
  <FileTree.Folder name="data" defaultOpen>
    <FileTree.File name="0.ans" />
    <FileTree.File name="0.in" />
    <FileTree.File name="0.out" />
  </FileTree.Folder>
  <FileTree.File name="chk.cpp" />
  <FileTree.File name="cplib.hpp" />
</FileTree>

åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•ä½ çš„ Checkerï¼š

```cmd
.\chk data\0.in data\0.out data\0.ans
```

å¦‚æœåˆ°æ­¤ä¸ºæ­¢ä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šçœ‹åˆ° Checker è¾“å‡ºä»¥ä¸‹ç»“æœï¼š

```ansi
[0;32mAccepted[0m, scores [0;33m100.0[0m of 100.
```

<Callout type="warning">
Windows 10 [è‡ª v1511 èµ·](https://www.reddit.com/r/Windows10/comments/44czox/windows_10_v1511_adds_support_for_ansi_escape/) æ”¯æŒ ANSI é¢œè‰²ï¼å¦‚æœä½ åœ¨ä½¿ç”¨æ—©æœŸç‰ˆæœ¬çš„ Windowsï¼Œä¸” Checker çš„è¾“å‡ºåŒ…å«æ— æ³•è¯†åˆ«çš„ä¹±ç ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆï¼š

- å®‰è£… [ANSICON](https://github.com/adoxa/ansicon)ï¼Œè¿™ä¼šåœ¨ cmd.exe ä¸­å¯ç”¨ ANSI é¢œè‰²ï¼
- ä½¿ç”¨å…¶ä»–æ”¯æŒ ANSI é¢œè‰²çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼
- è®¾ç½® `NO_COLOR=1` ç¯å¢ƒå˜é‡ï¼Œè¿™ä¼šç›´æ¥ç¦ç”¨ Checker çš„é¢œè‰²è¾“å‡ºï¼
</Callout>
</Tab>
</Tabs>

<Callout>
å¦‚æœä½ æƒ³è¦è‡ªå·±åŠ¨æ‰‹æ“ä½œï¼Œå¯ä»¥ï¼š

- å°è¯•æ›´æ”¹ä½ çš„æµ‹è¯•ç‚¹è¾“å…¥æ–‡ä»¶ã€é€‰æ‰‹è¾“å‡ºæ–‡ä»¶å’Œæ ‡å‡†ç­”æ¡ˆæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¹¶è§‚å¯Ÿ Checker è¾“å‡ºçš„å˜åŒ–ï¼
- æ‰§è¡Œ `./chk --help`ï¼Œè§‚å¯Ÿæ”¹å˜ `--report-format` å‘½ä»¤è¡Œå‚æ•°å’Œè®¾ç½® `NO_COLOR=1` æˆ– `CLICOLOR_FORCE=1` ç¯å¢ƒå˜é‡å¯¹ Checker è¾“å‡ºçš„å½±å“ï¼
</Callout>

## è¿›é˜¶

<Callout type="info">
æœ¬èŠ‚çš„ç›¸å…³ä»£ç è§ [GitHub ä»“åº“](https://github.com/rindag-devs/cplib/tree/main/tests/checker/2-shortest-path)ï¼
</Callout>

ç®—æ³•ç«èµ›ä¸­å®é™…çš„é¢˜ç›®ä¸ä¼šåƒ A+B è¿™ä¹ˆç®€å•ï¼å½“æˆ‘ä»¬çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­ï¼

> **é¢˜ç›®æè¿°**ï¼šç»™å®šä¸€å¼ ç‚¹æ•°ä¸º $n$ï¼ˆ$1 \le n \le 100$ï¼‰ï¼Œè¾¹æ•°ä¸º $m$ï¼ˆ$1 \le n \le 100$ï¼‰çš„æ— å‘è¿é€šç®€å•å›¾ï¼Œç¬¬ $i$ æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«ä¸º $u_i$ å’Œ $v_i$ï¼ˆ$1 \le u_i, v_i \le n$ï¼‰ï¼Œè¾¹æƒä¸º $w_i$ï¼ˆ$1 \le w_i \le 100$ï¼‰ï¼ä½ éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼šæ±‚å‡ºä» $1$ åˆ° $n$ æœ€çŸ­è·¯å¾„çš„æƒå€¼å’Œï¼Œä»¥åŠè¾“å‡ºä»»æ„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼
>
> **è¾“å…¥æ ¼å¼**ï¼šç¬¬ä¸€è¡Œè¾“å…¥ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $m$ï¼æ¥ä¸‹æ¥ $m$ è¡Œæ¯è¡Œè¾“å…¥ä¸‰ä¸ªæ•´æ•° $u_i,v_i,w_i$ï¼
>
> **è¾“å‡ºæ ¼å¼**ï¼šç¬¬ä¸€è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•° $\mathit{sum}$ï¼Œè¡¨ç¤ºç¬¬ä¸€é—®çš„ç­”æ¡ˆï¼ç¬¬äºŒè¡Œé¦–å…ˆè¾“å‡ºä¸€ä¸ªåœ¨ $[1,n^2]$ åŒºé—´å†…çš„æ•´æ•° $\mathit{len}$ï¼Œè¡¨ç¤ºæœ€çŸ­è·¯å¾„ç»è¿‡çš„ç‚¹æ•°ï¼ç„¶åè¾“å‡º $\mathit{len}$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€çŸ­è·¯å¾„ä¾æ¬¡ç»è¿‡çš„ç»“ç‚¹ç¼–å·ï¼ˆéœ€è¦åŒ…å«æœ€å¼€å§‹çš„ $1$ å’Œæœ€æœ«å°¾çš„ $n$ï¼‰ï¼

ç¼–å†™æ›´ä¸ºå¤æ‚çš„ Checker æ—¶ï¼Œåƒä¸Šä¸ªç¤ºä¾‹ä¸€æ ·æŠŠå…¨éƒ¨é€»è¾‘éƒ½å†™åœ¨ `checker_main` é‡Œæ˜¯ä¸€ç§ **éå¸¸é”™è¯¯** çš„é€‰æ‹©ï¼ä¸‹é¢ç»™å‡ºäº†ä¸€ä¸ªæ›´æ˜“é˜…è¯»å’Œç»´æŠ¤çš„ Checker å®ç°ï¼š

```cpp filename="chk.cpp" copy showLineNumbers
#include <map>
#include <utility>
#include <vector>

#include "cplib.hpp"

using namespace cplib;

CPLIB_REGISTER_CHECKER(chk);

struct Edge {
  int u, v, w;

  static Edge read(var::Reader& in) {
    auto [u, v, w] = in(var::i32("u"), var::i32("v"), var::i32("w"));
    return {u, v, w};
  }
};

struct Input {
  int n, m;
  std::map<std::pair<int, int>, int> graph;

  static Input read(var::Reader& in) {
    auto [n, m] = in(var::i32("n"), var::i32("m"));
    auto edges = in.read(var::ExtVar<Edge>("edges") * m);

    std::map<std::pair<int, int>, int> graph;
    for (auto [u, v, w] : edges) {
      graph[{u, v}] = w;
      graph[{v, u}] = w;
    }

    return {n, m, graph};
  }
};

struct Output {
  int sum, len;
  std::vector<int> plan;

  static Output read(var::Reader& in, const Input& input) {
    auto [sum, len] = in(var::i32("sum", 0, std::nullopt), var::i32("len", 1, std::nullopt));
    auto plan = in.read(var::i32("plan", 1, input.n) * len);

    if (plan.front() != 1) in.fail("Plan should begin with 1");
    if (plan.back() != input.n) in.fail("Plan should end with n");
    int result_sum = 0;
    for (int i = 1; i < (int)plan.size(); ++i) {
      if (!input.graph.count({plan[i - 1], plan[i]}))
        in.fail(format("Edge %d <-> %d does not exist", plan[i - 1], plan[i]));
      result_sum += input.graph.at({plan[i - 1], plan[i]});
    }
    if (result_sum != sum) in.fail("Plan and shortest path length do not match");

    return {sum, len, plan};
  }

  static void check(const Output& expected, const Output& result) {
    if (result.sum < expected.sum)
      chk.quit_wa(format("Wrong sum, expected %d, got %d", expected.sum, result.sum));

    if (result.sum > expected.sum)
      panic(format("Contestant answers are better than standard answers, expected %d, got %d",
                   expected.sum, result.sum));
  }
};

void checker_main() {
  auto input = chk.inf.read(var::ExtVar<Input>("input"));

  auto output = var::ExtVar<Output>("output", input);
  auto ouf_output = chk.ouf.read(output);
  auto ans_output = chk.ans.read(output);

  Output::check(ans_output, ouf_output);
  chk.quit_ac();
}

```

è¿™ä¸ªç¤ºä¾‹å±•ç°äº†å¦‚ä½•å¯¹è‡ªå®šä¹‰ç±»å‹ä½¿ç”¨å˜é‡è¯»å…¥æ¨¡æ¿è¿›è¡Œè¯»å…¥ï¼

é¦–å…ˆå®šä¹‰ç»“æ„ä½“ `Edge` æè¿°ä¸€æ¡è¾¹ï¼å¦‚æœæˆ‘ä»¬è¦åˆ›å»ºè¯»å…¥ `Edge` çš„å˜é‡è¯»å…¥æ¨¡æ¿ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ `cplib::var::ExtVar`ï¼ä½¿ç”¨å®ƒä¹‹å‰ï¼Œéœ€è¦ä¸º `Edge` ç»“æ„ä½“ç¼–å†™åç§°ä¸º `read` çš„ public static æ–¹æ³•ï¼è¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå½¢å‚ç±»å‹å¿…é¡»ä¸º `cplib::var::Reader&`ï¼šå³ä¸ŠèŠ‚ä»‹ç»çš„çš„ `chk.inf`ã€`chk.ouf`ã€`chk.ans` å¯¹è±¡å¯¹åº”çš„ç±»å‹çš„å¼•ç”¨ï¼åç»­å½¢å‚å¯ä»¥ä»»æ„å®šä¹‰ï¼

ä¸Šä¸€èŠ‚çš„ä»£ç å±•ç¤ºäº† `cplib::var::Reader` ç±»å‹çš„ `.read` æ–¹æ³•ï¼è€Œ `Edge::read` çš„å®ç°ä½¿ç”¨äº†å®ƒçš„ `operator()` è¿ç®—ç¬¦é‡è½½ï¼è¯¥è¿ç®—ç¬¦ä¼šä¾æ¬¡ä»¥å¤šä¸ªå˜é‡è¯»å…¥æ¨¡æ¿çš„å®ä¾‹ä½œä¸ºå‚æ•°è°ƒç”¨ `.read`ï¼Œå¹¶å°†æ‰€æœ‰çš„ç»“æœæŒ‰é¡ºåºæ‰“åŒ…ä¸ºä¸€ä¸ª `std::tuple` è¿”å›ï¼åœ¨è¯»å…¥å¤šä¸ª **ä¸å­˜åœ¨ä¾èµ–å…³ç³»** çš„å˜é‡æ—¶ï¼Œä½¿ç”¨ `operator()` å¯è®©ä»£ç æ›´åŠ ç®€çŸ­ï¼

CPLib æä¾›äº† `cplib::var::Vec` æ¥åˆ›å»º `std::vector` çš„å˜é‡è¯»å…¥æ¨¡æ¿ï¼ŒåŒæ—¶ä¸º `cplib::var::Var` å®ç°äº† `operator*(size_t)`ï¼ä½¿ç”¨ç±»ä¼¼ä»£ç ä¸­ `Input::read` ä¸­çš„è¯­æ³•å°†ä»»æ„ä¸€ä¸ª `cplib::var::Var` å­ç±»çš„å¯¹è±¡ä¸æ•´æ•°ç›¸ä¹˜æ¥å¿«é€Ÿåˆ›å»º `cplib::var::Vec`ï¼

ç¼–å†™å®Œ `Edge::read` åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ `cplib::var::ExtVar<Edge>` æ¥åˆ›å»ºä¸€ä¸ªé€šè¿‡è°ƒç”¨ `Edge::read` æ¥è¯»å…¥ `Edge` ç±»å‹çš„å˜é‡è¯»å…¥æ¨¡æ¿äº†ï¼å½“å®ä¾‹åŒ–ä¸€ä¸ªä»¥ `T` ä¸ºç›®æ ‡è¯»å…¥ç±»å‹çš„ `cplib::var::ExtVar<T>` æ—¶ï¼Œè‹¥ `T::read` çš„å‚æ•°æ•°é‡å¤§äºç­‰äº $2$ ä¸ªï¼Œåˆ™ä½ éœ€è¦æ ¹æ® `T::read` çš„ç¬¬äºŒä¸ªè‡³æœ€åä¸€ä¸ªå½¢å‚æ¥å‘ `cplib::var::ExtVar<T>` çš„æ„é€ å‡½æ•°ä¼ é€’å®å‚ï¼å¦‚æœåƒæœ¬ä¾‹çš„ `Edge` ç±»å‹è¿™æ ·ï¼Œå…¶ `Edge::read` æ–¹æ³•åªæœ‰ä¸€ä¸ªå½¢å‚ï¼Œåˆ™æ„é€ å‡½æ•°ä¸éœ€è¦ä¼ é€’ä»»ä½•å®å‚ï¼

åœ¨å¯ä»¥æå‰ï¼ˆåœ¨è¯»å…¥å…¨éƒ¨é€‰æ‰‹è¾“å‡ºå‰ï¼‰æ£€æŸ¥é€‰æ‰‹è¾“å‡ºæ˜¯å¦å…·æœ‰ã€Œæœ‰æ•ˆæ€§ã€æ—¶ï¼Œæˆ‘ä»¬æ¨èä½ æŠŠæ£€æŸ¥ã€Œæœ‰æ•ˆæ€§ã€çš„é€»è¾‘å†™åœ¨å¯¹åº”ç±»å‹çš„ `read` æ–¹æ³•é‡Œï¼Œä¾‹å¦‚æœ¬ä¾‹ä¸­ `Output::read` çš„å®ç°ï¼è‹¥å‡ºç°è¯»å…¥ä¸ç¬¦åˆé¢˜ç›®è¦æ±‚çš„æƒ…å†µï¼Œåº”ä½¿ç”¨ `in.fail(message)` å‡½æ•°æ¥æŠ¥å‘Šé”™è¯¯ï¼è¯¥å‡½æ•°ä¼šä»¥ä¼ å…¥çš„å‚æ•° `message` å’Œå½“å‰çš„è¯»å…¥æ ˆè½¨è¿¹ï¼ˆTraceï¼‰ç”Ÿæˆé”™è¯¯æŠ¥å‘Šå¹¶é€€å‡ºç¨‹åºï¼Œ`Reader` å¯¹åº”è¾“å…¥æµçš„ä¸åŒå†³å®šæŠ¥å‘Šçš„é”™è¯¯ç±»å‹ï¼ä¾‹å¦‚åœ¨ Checker ä¸­ï¼Œå¯¹ `chk.inf` å’Œ `chk.ans` æµè°ƒç”¨ `fail` ä¼šè¿”å› `Internal Error` é”™è¯¯ç±»å‹ï¼Œè€Œ `chk.ouf` æµåˆ™æ˜¯ `Wrong Answer`ï¼

æ£€æŸ¥å®Œã€Œæœ‰æ•ˆæ€§ã€ä¹‹åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æ£€æŸ¥é€‰æ‰‹è¾“å‡ºå’Œæ ‡å‡†ç­”æ¡ˆçš„ã€Œç­‰ä»·æ€§ã€ï¼Œæˆ‘ä»¬æ¨èä½ åœ¨æ¯ä¸ªéœ€è¦è¿›è¡Œæ¯”è¾ƒçš„ç±»å‹ä¸Šå®ç°ä¸€ä¸ªé™æ€çš„ `check(expected, result)` æ–¹æ³•ï¼Œå¹¶åœ¨ `checker_main` ä¸­è°ƒç”¨æœ€å¤–å±‚ç±»å‹ `Output` çš„ `check` æ–¹æ³•ï¼æœ€ååœ¨ `check` å‡é€šè¿‡åè°ƒç”¨ `chk.quit_ac`ï¼

## å»ºè®®

ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨ç¼–å†™è¾ƒä¸ºå¤æ‚çš„ Checker æ—¶ï¼Œæˆ‘ä»¬æ¨èä½ éµå¾ªå¦‚ä¸‹å»ºè®®ï¼š

- ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹å’Œ `cplib::var::ExtVar` å°è£…ä½ çš„ä»£ç ï¼Œè€Œä¸æ˜¯å®Œå…¨ä½¿ç”¨åŸºæœ¬ç±»å‹è¯»å…¥ï¼
- æ£€éªŒ `T` çš„ã€Œæœ‰æ•ˆæ€§ã€æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘åœ¨ `T::read` ä¸­å®ç°ï¼å…¶æ¬¡è€ƒè™‘åœ¨ `T::check` ä¸­å¯¹ `result` å‚æ•°å•ç‹¬æ£€éªŒï¼
- æ£€éªŒ `T` çš„ã€Œç­‰ä»·æ€§ã€æ—¶ï¼Œè€ƒè™‘åœ¨ `T::check` ä¸­å®ç°ï¼Œæœ€ååªåœ¨ `checker_main` ä¸­è°ƒç”¨æœ€å¤–å±‚å˜é‡çš„ `check` æ–¹æ³•ï¼
- å¯¹äºä»…åœ¨æµ‹è¯•ç‚¹è¾“å…¥æ–‡ä»¶ä¸­å‡ºç°çš„ç±»å‹ï¼Œæ²¡æœ‰å¿…è¦å¯¹å…¶å®ç°æœ‰æ•ˆæ€§æ£€éªŒï¼šä½ åº”è¯¥ Validator ä¸­åšè¿™ä»¶äº‹ï¼

<Callout>
å¦‚æœä½ æƒ³è¦è‡ªå·±åŠ¨æ‰‹æ“ä½œï¼Œå¯ä»¥ï¼š

å°è¯•ç¼–å†™ä»¥ä¸‹é¢˜ç›®çš„ Checkerï¼

**é¢˜ç›®æè¿°**ï¼šå¯¹äºä¸€ä¸ª $n$ï¼ˆ$1 \le n \le 10^5$ï¼‰ä¸ªèŠ‚ç‚¹ $m$ï¼ˆ$1 \le m \le 10^5$ï¼‰æ¡æ— å‘è¾¹çš„å›¾ï¼Œè¯·è¾“å‡ºå…¶è¾¹åŒè¿é€šåˆ†é‡çš„ä¸ªæ•°ï¼Œå¹¶ä¸”è¾“å‡ºæ¯ä¸ªè¾¹åŒè¿é€šåˆ†é‡ï¼

**è¾“å…¥æ ¼å¼**ï¼šç¬¬ä¸€è¡Œè¾“å…¥ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $m$ï¼æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° $u,v$ï¼Œè¡¨ç¤ºä¸€æ¡æ— å‘è¾¹ï¼

**è¾“å‡ºæ ¼å¼**ï¼šç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•° $x$ è¡¨ç¤ºè¾¹åŒè¿é€šåˆ†é‡çš„ä¸ªæ•°ï¼æ¥ä¸‹æ¥çš„ $x$ è¡Œï¼Œæ¯è¡Œç¬¬ä¸€ä¸ªæ•° $a$ è¡¨ç¤ºè¯¥åˆ†é‡ç»“ç‚¹ä¸ªæ•°ï¼Œç„¶å $a$ ä¸ªæ•°ï¼Œæè¿°ä¸€ä¸ªè¾¹åŒè¿é€šåˆ†é‡ï¼ä½ å¯ä»¥ä»¥ä»»æ„é¡ºåºè¾“å‡ºè¾¹åŒè¿é€šåˆ†é‡ä¸è¾¹åŒè¿é€šåˆ†é‡å†…çš„ç»“ç‚¹ï¼

å‚è€ƒå®ç°è§ [GitHub ä»“åº“](https://github.com/rindag-devs/cplib/tree/main/tests/checker/3-set-of-sets)ï¼
</Callout>
